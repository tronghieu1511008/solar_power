<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Solar Sower - Account Management</title>

  <base href="/">
  <!-- Bootstrap core CSS-->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template-->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">

  <!-- Page level plugin CSS-->
  <link href="vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet">
  <!-- icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- Custom styles for this template-->
  <link href="css/sb-admin.css" rel="stylesheet">
  
</head>

<body id="page-top">

  <nav class="navbar navbar-expand navbar-dark bg-dark static-top" style="padding-top:1px;padding-bottom: 1px">

      <a href="/mainDashboard" style='text-decoration: none;'> <span style="color: red; font-size: 18px ">Admin Dashboard</span></a>

    <button class="btn btn-link btn-sm text-white order-1 order-sm-0" id="sidebarToggle" href="#">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Navbar Search -->
    <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
      <!-- <div class="input-group">
        <input type="text" class="form-control" placeholder="Search for..." aria-label="Search"
          aria-describedby="basic-addon2">
        <div class="input-group-append">
          <button class="btn btn-primary" type="button">
            <i class="fas fa-search"></i>
          </button>
        </div>
      </div> -->
    </form>

    <!-- Navbar -->
    <ul class="navbar-nav ml-auto ml-md-0">
      <!-- <li class="nav-item dropdown no-arrow mx-1">
        <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-bell fa-fw"></i>
          <span class="badge badge-danger">9+</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="alertsDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li> -->
      <!-- <li class="nav-item dropdown no-arrow mx-1">
        <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-envelope fa-fw"></i>
          <span class="badge badge-danger">7</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="messagesDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li> -->
      <li>
        <p class="my-2" style="color: white">
            <!--  -->
        </p>
    </li>
      <li class="nav-item dropdown no-arrow">
        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-user-circle fa-lg"></i>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
          
          <!-- <div class="dropdown-divider"></div> -->
          <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal" >
            <button class="btn btn-outline-dark" style="border: none"><i class="fa fa-sign-out"></i>Logout</button>
          </a>
        </div>
      </li>
    </ul>

  </nav>

  <div id="wrapper">

    <!-- Sidebar -->
    <ul class="sidebar navbar-nav">
      <!-- Dashboar navbar -->
      <li class="nav-item " href="#dashboardArea" data-toggle="collapse">
        <a class="nav-link " style="padding: 12px 10px">
          <i class="fa fa-tachometer"></i>
          <span style="font-size: 14px">Dashboard</span>
        </a>
      </li>
      <li class="nav-item collapse" id="dashboardArea">
        <a class="nav-link" style="padding: 5px 10px">
          <span style="font-size: 14px;">--Area A--</span>
        </a>
        <a class="nav-link" href="/dashboard" style="padding: 5px 10px">
          <span style="font-size: 13px;">Solar AS-0</span>
        </a>
        <a class="nav-link" href="/dashboard_1" style="padding: 5px 10px">
          <span style="font-size: 13px;">Solar AS-1</span>
        </a>
        <a class="nav-link" style="padding: 5px 10px">
          <span style="font-size: 14px;">--Area B--</span>
        </a>
        <a class="nav-link" href="/dashboard_2" style="padding: 5px 10px">
          <span style="font-size: 13px">Solar BS-0</span>
        </a>
        <a class="nav-link" href="/dashboard_3" style="padding: 5px 10px">
          <span style="font-size: 13px;">Solar BS-1</span>
        </a>
        <hr style="border-color: white;margin: 0;padding: 0;">
      </li>
      <!-- Control navbar -->
      <li class="nav-item " href="#controlArea" data-toggle="collapse">
        <a class="nav-link " style="padding: 12px 10px">
          <i class="fa fa-cogs"></i>
          <span style="font-size: 14px">Control</span>
        </a>
      </li>
      <li class="nav-item collapse" id="controlArea">
        <a class="nav-link" style="padding: 2px 10px;">
          <span style="font-size: 14px;">--Area A--</span>
        </a>
        <a class="nav-link" href="/control" style="padding: 5px 10px">
          <span style="font-size: 13px;">Pump AP-0</span>
        </a>
        <a class="nav-link" href="/control_1" style="padding: 5px 10px">
          <span style="font-size: 13px;">Pump AP-1</span>
        </a>
        <a class="nav-link" style="padding: 2px 10px;">
          <span style="font-size: 14px;">--Area B--</span>
        </a>
        <a class="nav-link" href="/control_2" style="padding: 5px 10px">
          <span style="font-size: 13px">Pump BP-2</span>
        </a>
        <a class="nav-link" href="/control_3" style="padding: 5px 10px">
          <span style="font-size: 13px;">Pump BP-1</span>
        </a>
        <hr style="border-color: white;margin: 0;padding: 0;">
      </li>
      <!-- Report navbar -->
      <li class="nav-item ">
        <a class="nav-link " href="/report">
          <i class="fa fa-database"></i>
          <span style="font-size: 14px">Report</span>
        </a>
      </li>
      <!-- Map navbar -->
      <li class="nav-item ">
        <a class="nav-link " href="/map">
          <i class="fa fa-map"></i>
          <span style="font-size: 14px">Map</span></a>
      </li>
      <!-- Accounts navbar -->
        <li class="nav-item active">
            <a class="nav-link " href="/admin">
                <i class="fa fa-user-circle-o"></i>
                <span style="font-size: 14px">Users</span></a>
        </li>
    </ul>

    <div id="content-wrapper">
      <div class="container-fluid">
        
        <!-- Breadcrumbs-->
        <!-- <ol class="breadcrumb">
            <li class="breadcrumb-item">
              <a href="#">Dashboard</a>
            </li>
            <li class="breadcrumb-item active">Tables</li>
          </ol> -->

        <!-- ThÃ´ng tin Account DataTables  -->
        <div class="card mb-3">
          <div class="card-header bg-dark text-white" style="padding: 5px 10px;font-size: 19px;">
            <i class="fas fa-table"></i>
            Users Table
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                <thead>
                  <tr>

                    <th>User Account</th>

                    <th>Role</th>
                    <th>Option</th>
                  </tr>
                </thead>

                <tbody>

                  <% for(var account of user){%>
                  <tr>
                    <td><%=account.email%></td>
                    <td>
                      <% if(account.isAdmin == true){ %>
                      <span style="color: red">Admin</span><i class="fa fa-star" style="color:red"></i>
                      <% } else{ %>
                      <span style="color: black">User</span>
                      <% } %>
                    </td>
                    <td>
                      <div class="dropdown">
                        <button type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown">
                          Option
                        </button>
                        <div class="dropdown-menu">
                          <!-- delete button -->
                          <% if(account.isAdmin == true){ %>
                          <a class="dropdown-item" href="" id="del" data-toggle="modal" data-target="#deleteModal">
                            <button class="btn btn-outline-dark " style="border: none;padding-right: 65px" onclick="getIdEmail('<%= account._id%>')" disabled><i
                                class="fa fa-trash"></i> Delete </button></a>
                                <% } else{ %>
                                  <a class="dropdown-item" href="" id="del" data-toggle="modal" data-target="#deleteModal">
                                      <button class="btn btn-outline-dark " style="border: none;padding-right: 65px" onclick="getIdEmail('<%= account._id%>')"><i
                                          class="fa fa-trash"></i> Delete </button></a>
                                  <% } %>
                                <!-- change password button -->
                                <a class="dropdown-item" href=""  data-toggle="modal" data-target="#editPassModal">
                                    <button class="btn btn-outline-dark " style="border: none" onclick="getNameIdEmail('<%= account.email%>','<%= account._id%>')"><i
                                        class="fa fa-pencil"></i> Edit Password</button></a>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <%}%>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="card-footer small text-muted">
                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#myRegister"><i class="fa fa-plus" aria-hidden="true"></i> Add User</button>
            </div>
          </div>

          <!-- <p class="small text-center text-muted my-5">
            <em>More table examples coming soon...</em>
          </p> -->

        </div>
        <!-- /.container-fluid -->

        <!-- Sticky Footer -->
        <!-- <footer class="sticky-footer">
          <div class="container-fluid my-auto">
            <div class="copyright text-center my-auto">
              <span>Copyright Â© Your Website 2018</span>
            </div>
          </div>
        </footer> -->

      </div>

    </div>
    <!-- /#wrapper -->
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
    </a>
    <!-- Sign Up -->
    <div class="modal fade" id="myRegister" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" >
          <!-- Modal sign content-->
          <div class=" modal-content">
            <div>
              <div class="modal-header card-header">
                  <h5>Register an Account</h5>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
              </div>
              <!-- show any messages that come back with authentication -->
              <div id="form_register_warning" ></div>
            </div>
            <div class="modal-body card-body">
                <div class="text-center mb-4">
                    <h6>Enter Email address and Password</h6>
                  </div>
              <form action="/signup" method="post" id="form_register">
                <div class="form-group">
                  <div class="form-label-group">
                    <input type="email" id="registerEmail" name="email" class="form-control"
                      placeholder="Email address" required="required">
                    <label for="registerEmail">Email address</label>
                  </div>
                </div>
                <div class="form-group">
                  <div class="form-label-group">
                    <input type="password" id="registerPassword" name="password" class="form-control"
                      placeholder="Password" required="required">
                    <label for="registerPassword">Password</label>
                  </div>
                  <div style="margin-top: 5px">
                    <input type="checkbox" onclick="myFunction()"> Show Password
                  </div>
                  <div style="margin-top: 5px">
                    <input type="radio" name="role" value="isUser" checked> User<br>
                    <input type="radio" name="role" value="isAdmin"><span style="color: red"> Admin </span><i
                      class="fa fa-star" style="color:red"></i>
                  </div>
                </div>
                <button class="btn btn-primary btn-block" type="submit">Register</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    <!--  -->
    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">Ã</span>
            </button>
          </div>
          <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
          <div class="modal-footer">
            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            <a class="btn btn-primary" href="/logout">Logout</a> 
          </div>
        </div>
      </div>
    </div>
    <!-- delete Modal-->
    <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Ready to Delete Account?</h5>
              <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">Ã</span>
              </button>
            </div>
            <div class="modal-body">Select "Delete" below if you are ready to Delete account.</div>
            <div class="modal-footer">
              <button class="btn btn-secondary" type="button" data-dismiss="modal" >Cancel</button>
              <!-- delete account -->
              <form action="/delete" method="post">
                <input type="hidden" name="delEmail" id="inputEmail" >
                <button class="btn btn-danger" type="submit">DELETE</button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!-- change password Modal-->
      <div class="modal fade" id="editPassModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <!-- content -->
          <div class="modal-header card-header">
            <h5>Reset Password</h5>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          
          <div class="modal-body card-body">
          <div class="text-center mb-4">
            <h6>Enter new password</h6>
          </div>
          <form action="/editPass" method="post">
            <!-- get Id -->
            <div class="form-group">
              <div class="form-label-group">
                <input type="hidden" name="inputIdEmail" id="inputIdEmail" >
                </div>
              </div>
              <!-- get Name Email -->
            <div class="form-group">
            <div class="form-label-group">
                <input type="email" id="inputNameEmail" name="nameEmail" class="form-control"
                  placeholder="Email address" required="required" disabled >
                <label for="inputNameEmail">Email address</label>
              </div>
            </div>
            <!-- get Password -->
            <div class="form-group">
              <div class="form-label-group">
                <input type="password" id="replacePass" name="newPassword" class="form-control" placeholder="Enter email address" required="required" autofocus="autofocus" value="">
                <label for="replacePass">Enter password</label>
              </div>
              <div style="margin-top: 5px">
                  <input type="checkbox" onclick="myFunction1()"> Show Password
                </div>
            </div>
            <button class="btn btn-primary btn-block" type="submit">Change Password</button>
          </form>
          
          </div> 
          </div>
        </div>
      </div>
      
    <!-- show password -->
    <script>
      function myFunction() {
        var x = document.getElementById("registerPassword");
        if (x.type === "password") {
          x.type = "text";
        } else {
          x.type = "password";
        }
      }
      function myFunction1() {
        var x = document.getElementById("replacePass");
        if (x.type === "password") {
          x.type = "text";
        } else {
          x.type = "password";
        }
      }
    </script>
    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Page level plugin JavaScript-->
    <script src="vendor/datatables/jquery.dataTables.js"></script>
    <script src="vendor/datatables/dataTables.bootstrap4.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin.min.js"></script>

    <!-- Demo scripts for this page-->
    <script src="js/demo/datatables-demo.js"></script>
    <!-- delete Account -->
    <script>
      // get iD email to delete
      function getIdEmail(idEmail) {
        $('#inputEmail').val(idEmail);
      };
      // change Password
      function getNameIdEmail(nameEmail,idEmail01) {
        $('#inputNameEmail').val(nameEmail);
        $('#inputIdEmail').val(idEmail01);
      };  
    </script>
    <script>
      // thu navbar
      window.addEventListener("load", function (event) {
            $("body").toggleClass("sidebar-toggled");
            $(".sidebar").toggleClass("toggled");
        })
    </script>
    <!-- ajax -->
    <script>
      // ajax register form
      $("#form_register").submit(function(event){
      event.preventDefault(); //prevent default action 
      var post_url = $(this).attr("action"); //get form action url
      var form_data = $(this).serialize(); //Encode form elements for submission
      
      $.post( post_url, form_data, function( response ) {
        if(response=="1"){
          location.reload();
        }
        else
          $("#form_register_warning").html( 
            "<div class='alert alert-warning alert-dismissible'> <button type='button' class='close' data-dismiss='alert'>&times;</button> <strong>Warning!</strong> This Email address has been registered. </div>"
          );
      });
    });
    </script>
  </body>

</html>